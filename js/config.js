import { zip } from 'lodash'

export const PIECES = [
  undefined, // empty
  [
    // t
    [[0, 1, -1, 0], [0, 0, 0, 1]],
    [[0, 0, 0, 1], [0, -1, 1, 0]],
    [[0, -1, 1, 0], [0, 0, 0, -1]],
    [[0, 0, 0, -1], [0, 1, -1, 0]],
  ],
  [
    // q
    [[0, 1, -1, -1], [0, 0, 0, 1]],
    [[0, 0, 0, 1], [0, -1, 1, 1]],
    [[0, -1, 1, 1], [0, 0, 0, -1]],
    [[0, 0, 0, -1], [0, 1, -1, -1]],
  ],
  [
    // p
    [[0, 1, -1, 1], [0, 0, 0, 1]],
    [[0, 0, 0, 1], [0, -1, 1, -1]],
    [[0, -1, 1, -1], [0, 0, 0, -1]],
    [[0, 0, 0, -1], [0, 1, -1, 1]],
  ],
  [[[0, -1, 1, 0], [0, 0, 1, 1]], [[0, 0, 1, 1], [0, 1, -1, 0]]], // z
  [[[0, 1, -1, 0], [0, 0, 1, 1]], [[0, 0, 1, 1], [0, -1, 1, 0]]], // s
  [[[0, 1, -1, -2], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, -1, 1, 2]]], // l
  [[[0, 1, 1, 0], [0, 0, 1, 1]]], // o
]

export const _pieces = {}
const _shapes = ['t', 'q', 'p', 'z', 's', 'l', 'o']
PIECES.slice(1).forEach((dxdys, i) => {
  const [dxs, dys] = dxdys[0]
  _pieces[_shapes[i]] = zip(dxs, dys).map(
    ([dx, dy]) => ({ dx, dy }), // eg {dx: 1, dy: -1}
  )
})

export const N_TYPES = PIECES.length - 1

export const N = 4

export default {
  N,
  PIECES,
  N_TYPES,
  _pieces,
  WIDTH: 10,
}
